sequenceDiagram

    participant Consumer

    participant Merchant

    participant {payment-gateway-abbr}

    participant Issuer

Consumer->>Merchant: initiates a 3DS2 payment

Merchant->>{payment-gateway-abbr}: sends check-enrollment request

{payment-gateway-abbr}->>{payment-gateway-abbr}: checks card data

{payment-gateway-abbr}->>Merchant: sends check-enrollment response

Merchant->>Issuer: sends PAReq

Issuer->>Consumer: shows authentication UI

Consumer->>Consumer: authenticates card data

Consumer->>Issuer: sends authentication result

Issuer->>Merchant: sends PARes

Merchant->>{payment-gateway-abbr}: sends check-payer-response request

{payment-gateway-abbr}->>Merchant: sends check-payer-response response
