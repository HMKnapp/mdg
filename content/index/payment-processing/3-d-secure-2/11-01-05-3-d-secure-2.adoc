[#CreditCard_3DS2]
== 3D Secure 2

[cols=",,", stripes=none]
|===
a|image::images/icons/3dsecure.png[3dsecure_icon, width=20%]
- <<CreditCard_PaymentFeatures_3DSecure, *From 3D Secure 1 to 3D Secure 2*>> +
- <<CreditCard_3DS2_Why, *Why Adopt 3D Secure 2?*>> +
- <<CreditCard_3DS2_PMs, *Supported Card Brands*>> 

//-

a|image::images/icons/help.png[help_icon, width=20%]
- <<CreditCard_PSD2, *What is PSD 2?*>> +
- <<CreditCard_PSD2_SCA, *What is SCA?*>>

//-

a|image::images/icons/integration.png[integration_icon, width=20%]
//- <<3DS2_IntegrationGuide, *General Integration Guide*>> +
//- <<3DS2_IntegrationGuide_REST, *3D Secure 2 for REST API*>> +
//- <<3DS2_Testing, *Testing*>> +
- <<CreditCard_3DS2_Fields, *Fields*>> +
- <<AppendixF, *Workflows*>>

//-

a|image::images/icons/processing.png[processing_icon, width=20%]
- <<CreditCard_3DS2_UseCases, *Use Cases*>> +
- <<#API_CC_3DS2_PaymentFlows, *Payment Flows*>>

//-

a|image::images/icons/speechbubble.png[speechbubble_icon, width=20%] 
https://www.wirecard.com/3d-secure-2/#faq[*FAQs*]

a|image::images/icons/latest-news.png[latest-news_icon, width=20%]
https://www.wirecard.com/3d-secure-2/#s19392[*Latest News*]
|===

include::{root}/index/payment-processing/3-d-secure-2/3-d-secure-1.adoc[leveloffset=+2]

The face of e-commerce has changed drastically since 3D Secure 1 was first introduced almost two decades ago. Mobile and in-app payment is booming, a seamless shopping experience more important than ever, and the demands on security growing.

As a result, the https://www.emvco.com/about/overview/[EMVCo] has devised a new standard authentication method for payment card transactions: *3D Secure 2 (3DS2).* 

This state-of-the-art protocol fulfills the <<CreditCard_PSD2_SCA, Strong Customer Authentication (SCA)>> requirements set by the https://ec.europa.eu/info/law/payment-services-psd-2-directive-eu-2015-2366_en[EU's Second Payment Services Directive (PSD 2)] for online payments within the European Economic Area (EEA).

[NOTE]
====
3DS2 is not yet supported in the APAC region. Please contact your relationship manager for more information.
====

include::{root}/index/payment-processing/3-d-secure-2/11-01-06-psd-2.adoc[leveloffset=+2]


[#CreditCard_3DS2_Why]
[discrete]
=== Why Adopt 3D Secure 2?

*3D Secure 2* is set to become the prime
authentication method for online card payments, thanks to a number of
updates that improve not only the security, but also the consumer
experience of 3D Secure 1 (3DS1):

//The 3D Secure 2 protocol has been
//designed for this brave new world and offers the flexibility needed to
//adapt to an ever-changing e-commerce landscape.

[#CreditCard_3DS2_Advantages]
[cols="30,70"]
|===
| *No More Static Passwords*
| The days of rummaging through your drawers to find your 3D Secure password are over. Consumers will no longer have to look for their passwords and are more likely to complete their purchases.
| *Two-Factor Authentication*
| 3DS2 implements two-factor authentication.
//<<CreditCard_PSD2, two-factor-authentication>>, as required by PSD 2. 
To make the experience more convenient for consumers, authentication can be completed, for example, with a token and a simple thumbprint.
| *Fewer False Declines*
| The new protocol provides ten times more information to the issuers, which helps drastically reduce the number of false declines. Consumers will retain their trust in 3DS2-secured transactions.
| *Mobile-Enabled Security*
| Consumers will no longer be redirected to potentially non-mobile-ready authorization pages.
| *Less Cart Abandonment*
| Overall greater convenience, a faster checkout process, and a seamless shopping experience will reduce shopping cart abandonment by 70%.
| *Merchant Opt-Out*
| As a merchant, if you decide for 3DS2, you regain the freedom to choose which transactions you send through the protocol and which ones you don't. However, please keep in mind that issuers may have to decline the transaction because SCA is required on their side.
|===

As with 3DS1, 3D Secure 2 also protects the merchant from liability in cases of fraud.

[cols="15a,85", stripes=none]
|===
^.^|image::images/icons/movie.png[movie_icon, width=48%] 
a| To learn more about how you can benefit from implementing 3D Secure 2, watch our webinars: 

- https://www.brighttalk.com/webcast/17162/366720?utm_campaign=channel-feed&utm_source=brighttalk-portal&utm_medium=web[Understanding 3D Secure 2: Boosting conversion and security in parallel] +
- https://www.brighttalk.com/webcast/17162/369743[Implementing 3D Secure 2: Best practices for a smooth transition] +
- https://www.brighttalk.com/webcast/17162/380084?utm_campaign=channel-feed&utm_source=brighttalk-portal&utm_medium=web[Transitioning to 3D Secure 2: Bring your business into the new security process]

//-

|===


'''


[#CreditCard_3DS2_PMs]
=== Supported Card Brands

3D Secure 2 has been developed, and is supported, by Mastercard, VISA,
American Express, UPI, Diners Club, Discover, and JCB.

- <<CreditCard, Credit Card>>
- <<PPv2_CC, Credit Card with {payment-page-v2-abbr}>>



[#CreditCard_3DS2_Help]
=== We Help You Transition

[#CreditCard_3DS2_Help_Workflow]
==== Workflow
The <<AppendixF, 3D Secure 2 workflow>> remains *identical* to the 3D Secure 1 workflow.

[#CreditCard_3DS2_PaymentProcessing]
.Payment Processing

3D Secure 1 and 3D Secure 2 include an additional transaction type in the transaction process: *check-enrollment.* +
*Check-enrollment* is the first step in a 3D Secure transaction. Its purpose is to authenticate the consumer's identity and confirm the consumer's willingness to pay the amount specified in the payment transaction.
With 3D Secure 2, the amount of data collected with *check-enrollment* is significantly higher than with 3D Secure 1.
This allows a more comprehensive risk analysis. +
A successful *check-enrollment* will return a ``parent-transaction-id``. Include this ``parent-transaction-id`` in the next step of the payment process.

For example, you would like to continue to <<AppendixB_TransactionTypesforCreditCard, authorize>> the payment amount: +

. Send a request with **check-enrollment.**
. The **check-enrollment** response returns a ``parent-transaction-id``.
. Send an **authorization** request including the ``parent-transaction-id``.

//-

//[NOTE]
//====
//All requests following a **check-enrollment** in the payment process:
//
//.. Contain the ``parent-transaction-id`` returned in the **check-enrollment** response //_OR_
//.. Are marked as <<CreditCard_PSD2_SCA_Exemptions, out-of-scope / exempt from PSD2>>
//====

See the <<CreditCard_Samples_CheckEnrollment_3DS2, XML request/response samples for check-enrollment>>.

More <<CreditCard_3DS2_UseCases, use cases and common business scenarios>> are available below. For more details on 3D Secure 2 fields, go to our <<CreditCard_3DS2_Fields, 3D Secure 2 field table>>.
Need more information on transaction types? Check out <<AppendixB_TransactionTypesforCreditCard,  Transaction Types for Credit Card>>.

[#CreditCard_3DS2_CheckEnrollment]
.Check-Enrollment Amount Handling & Policies

**Check-enrollment** has two functions:

. Authenticate the consumer's identity.
. Confirm the consumer's willingness to pay the amount specified in the payment transaction.

//-

Therefore, a **check-enrollment** request contains a ``requested-amount``. As a general rule, the amount provided in consecutive payment requests, e.g. during an **authorization,** should not exceed the amount provided in the referenced **check-enrollment** by more than what a consumer could reasonably expect. The margin of what is considered reasonable varies from card scheme to card scheme and ranges from 15-20%.
As a merchant, you are always on the safe side when the originally ``requested-amount`` is not exceeded by 15%.

[NOTE]
====
If you exceed the original ``requested-amount``, the transaction may be declined.
However, not all transactions that exceed the original ``requested-amount`` will fail.
In those cases, chargeback liability protection will not apply to the same extent as for fully authenticated amounts.
====

See the <<CreditCard_Samples_CheckEnrollment_3DS2, XML request/response samples for check-enrollment>>.

[#CreditCard_3DS2_Help_Integration]
==== Updated Integration Guides

Check out our updated integration guides for {payment-page-v2-abbr}:

- <<PaymentPageSolutions_PPv2_HPP_Integration, Hosted Payment Page>>
- <<PaymentPageSolutions_PPv2_EPP_Integration, Embedded Payment Page>>
- <<PPv2_Seamless_Integration, Seamless Mode>>

//-

New fields (NVP) have also been added to our Payment Page documentation:


- <<PP_3DSecure, 3D Secure for Payment Page>>

//-

