:txTypeName: voidAuthorization

[#KlarnaV2_TransactionTypes_voidAuthorization]
==== _void-authorization_

Use this transaction type to cancel an order, e.g. if the goods or services are not available
or the consumer wants to cancel their order. We recommend to cancel authorizations to avoid any influence on risk decisions for further payments.


You can cancel

* only authorized amounts that have not yet been completely captured.
* the **total order amount**.
* a **partial order amount**. If the order has been partially captured, a _void-authorization_ cancels only the part of the preceding _authorization_ that has not yet been captured.

//-

NOTE: Once canceled, you can no longer process the order. The initial authorization/reservation is no longer valid.

To refer to a specific _authorization_, _adjust-authorization_ or _pending-authorization_, you need the ``parent-transaction-id``, which is the ``transaction-id`` of the preceding transaction.

[#KlarnaV2_TransactionTypes_voidAuthorization_Workflow]
===== _void-authorization_ Workflow

[mermaid,Klarnav2_workflow_voidAuthorization,svg,subs=attributes+]
----
sequenceDiagram
    participant M as Merchant
    participant W as WPG
    participant K as Klarna
M-->>M: cancels order
M->>W: sends "void-authorization" request
W->>K: creates "void-authorization" transaction
W-->>W: capture check
    alt partial capture before
        W->>K: releases remaining auth. request
        K->>W: releases remaining order
    else no partial capture before
        W->>K: cancels authorization request
        K->>W: cancels authorization
    end
W->>M: creates/sends response
----

. -> Send a _void-authorization_ request. This request must contain the ``parent-transaction-id``. Enter the ``transaction-id`` of the preceding _authorization_, _adjust-authorization_ or _pending-authorization_ that is to be canceled.
. _{payment-gateway}_ checks if parts of this order have already been captured:
  ** If yes: _{payment-gateway}_ sends a _void-authorization_ request for the uncaptured order items to _Klarna_. 
  ** If no: _{payment-gateway}_ sends a _void-authorization_ request for the total order amount to _Klarna_. 
. _Klarna_ approves or rejects the void request and returns the result.
. _{payment-gateway}_ sends you the _void-authorization_ response which contains the status code.
. -> Process the _void-authorization_ response.

//-

[#KlarnaV2_TransactionTypes_voidAuthorization_Fields]
===== _void-authorization_ Fields

Fields can be **M**andatory or **O**ptional.

[%autowidth,stripes=none]
[cols="m,,,,"]
|===
|Field |<<APIRef_FieldDefs_Cardinality, M/O>> |Data Type |Size |Description

|merchant-account-id 
|O 
|String 
|36 
|A unique identifier assigned
to every merchant account (by {payment-provider-name}).

|request-id 
|M
|String 
|150 
a|A unique identifier assigned by the merchant
to each request. Used when searching for or referencing it later.

As the request ID must be unique, ``{{$guid}}`` serves as a placeholder; Postman
uses it to generate a random ``request-id`` for testing.

Allowed characters:  ``[a-z0-9-\_]``.

|transaction-type 
|M  
|String
|30 
|The requested transaction type. Set this field to ``void-authorization``.

|parent-transaction-id
|M
|String 
|36
|Enter the ``transaction-id`` of the preceding _authorization_, _adjust-authorization_ or _pending-authorization_.

|parent-transaction-amount
|Response only
|String 
|18,3
|``requested-amount`` of the preceding _authorization_, _adjust-authorization_ or _pending-authorization_.

|parent-transaction-amount@currency
|Response only
|String 
|3
|``requested-amount@currency`` of the preceding _authorization_, _adjust-authorization_ or _pending-authorization_.

|requested-amount  
|Response only
|Numeric
|18,3
|Total amount voided with this transaction. The number of decimal places depends on the currency.

|[[KlarnaV2_TransactionTypes_voidAuthorization_Fields_requestedAmount_currency]]requested-amount@currency 
|Response only
|String
|3 
a|The <<KlarnaV2_CountriesCurrencies, currency>> of the requested/contested
transaction amount. +
Format: 3-character abbreviation according to ISO 4217.

|order-detail
|Response only
|String
|
|``order-detail`` of the preceding _authorization_, _adjust-authorization_ or _pending-authorization_.

|order-number	
|Response only 
|String
|255 
|Order number of the merchant as sent in the preceding _authorization_, _adjust-authorization_ or _pending-authorization_. Shows as "order number" on _Klarna_'s payment confirmation page.

|locale	
|Response only
|String
|5 
|A 5-letter code that indicates what <<KlarnaV2_Locales, language>> the payment page is rendered in (RFC 1766).

|transaction-id 
|Response only
|String
|36
|A unique identifier assigned for every transaction. Generated by {payment-provider-name}. Used when searching for or referencing it later.

|transaction-state 
|Response only
|String
|12
a|Transaction status. +
Possible values: 

  - ``success``
  - ``failed``

//-

|completion-time-stamp
|Response only
|DateTime
|
|The timestamp documents the time and date when the transaction was completed.

include::{root}/include/klarna-payments/fields/klarnaPayments_fields_paymentMethod.adoc[tags=**;!mandatory;!MO;!recurring;!adjust-authorization;!initialAuthorization]

include::{root}/include/klarna-payments/fields/klarnaPayments_fields_notifications.adoc[]

include::{root}/include/klarna-payments/fields/klarnaPayments_fields_accountHolder_responseOnly.adoc[]

include::{root}/include/klarna-payments/fields/klarnaPayments_fields_accountHolderAddress_responseOnly.adoc[]

include::{root}/include/klarna-payments/fields/klarnaPayments_fields_shipping_followUp.adoc[tags=!*]

include::{root}/include/klarna-payments/fields/orderItems-responseOnly.adoc[]

include::{root}/include/klarna-payments/fields/klarnaPayments_fields_status.adoc[]

|===

[#KlarnaV2_TransactionTypes_voidAuthorization_Samples]
===== _void-authorization_ Samples

._void-authorization_ Request
[source,xml,subs=attributes+]
----
include::{root}/samples/xml/Klarnav2_voidAuthorization_request.xml[]
----

NOTE: {{txnId}} serves as placeholder. Enter the ``transaction-id`` of the preceding _authorization_, _adjust-authorization_ or _pending-authorization_ that is to be canceled.

._void-authorization_ Response
[source,xml,subs=attributes+]
----
include::{root}/samples/xml/Klarnav2_voidAuthorization_response.xml[]
----

:!txTypeName:

//-